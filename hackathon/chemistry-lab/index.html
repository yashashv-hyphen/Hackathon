<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Virtual Chemistry Lab — Titration Experiment</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Outfit:wght@400;600;700&display=swap" rel="stylesheet" />
</head>
<body>
  <div class="app">
    <header class="lab-header">
      <h1>Virtual Chemistry Lab</h1>
      <p class="subtitle">Acid–Base Titration • You perform the experiment</p>
      <p class="instructions">
        <button type="button" class="btn btn-eyes" id="btn-eyes" title="Eye control: pointer follows mouse or gaze. Stare to click, blink, or press Space.">
          <span class="btn-eyes-icon" aria-hidden="true"></span>
          <span id="btn-eyes-label">Use eyes (stare or blink to click)</span>
        </button>
        <span id="gaze-hint" class="gaze-hint" aria-live="polite"></span>
      </p>
    </header>

    <main class="lab-bench">
      <div class="bench-surface">
        <!-- Stand & clamp -->
        <div class="apparatus stand" id="stand" title="Adjust stand">
          <svg viewBox="0 0 80 200" class="stand-svg">
            <rect x="35" y="0" width="10" height="200" fill="currentColor" />
            <rect x="0" y="185" width="80" height="15" fill="currentColor" />
            <circle cx="40" cy="90" r="8" fill="var(--bench)" stroke="currentColor" stroke-width="2" />
          </svg>
        </div>

        <!-- Burette -->
        <div class="apparatus burette" id="burette" title="Click to open/close tap">
          <svg viewBox="0 0 120 280" class="burette-svg">
            <defs>
              <linearGradient id="buretteGlass" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#b8d4e8;stop-opacity:0.6" />
                <stop offset="50%" style="stop-color:#e8f4fc;stop-opacity:0.9" />
                <stop offset="100%" style="stop-color:#b8d4e8;stop-opacity:0.6" />
              </linearGradient>
              <linearGradient id="titrantLiquid" x1="0%" y1="100%" x2="0%" y2="0%">
                <stop offset="0%" style="stop-color:#4a7c9e" />
                <stop offset="100%" style="stop-color:#7eb8d4" />
              </linearGradient>
            </defs>
            <path d="M 25 20 L 25 260 L 95 260 L 95 20 Z" fill="url(#buretteGlass)" stroke="#5a8aa0" stroke-width="2" />
            <rect id="burette-liquid" x="28" y="255" width="64" height="0" fill="url(#titrantLiquid)" rx="2" />
            <g id="burette-tap">
              <rect x="48" y="255" width="24" height="20" fill="#3d5a6c" stroke="#2a3d4a" stroke-width="1" />
              <circle cx="60" cy="265" r="4" fill="#1a2d3a" />
            </g>
            <line x1="95" y1="40" x2="102" y2="40" stroke="#333" stroke-width="1" />
            <line x1="95" y1="80" x2="102" y2="80" stroke="#333" stroke-width="1" />
            <line x1="95" y1="120" x2="102" y2="120" stroke="#333" stroke-width="1" />
            <line x1="95" y1="160" x2="102" y2="160" stroke="#333" stroke-width="1" />
            <line x1="95" y1="200" x2="102" y2="200" stroke="#333" stroke-width="1" />
            <line x1="95" y1="240" x2="102" y2="240" stroke="#333" stroke-width="1" />
          </svg>
          <span class="apparatus-label">Burette (NaOH)</span>
        </div>

        <!-- Conical flask -->
        <div class="apparatus flask flask-empty" id="flask" title="Click to swirl during titration">
          <svg viewBox="0 0 140 180" class="flask-svg">
            <defs>
              <linearGradient id="flaskGlass" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#b8d4e8;stop-opacity:0.5" />
                <stop offset="50%" style="stop-color:#e8f4fc;stop-opacity:0.85" />
                <stop offset="100%" style="stop-color:#b8d4e8;stop-opacity:0.5" />
              </linearGradient>
              <linearGradient id="flaskAcid" x1="0%" y1="100%" x2="0%" y2="0%">
                <stop offset="0%" style="stop-color:#e8e0d0" />
                <stop offset="100%" style="stop-color:#f5f0e8" />
              </linearGradient>
              <linearGradient id="flaskPink" x1="0%" y1="100%" x2="0%" y2="0%">
                <stop offset="0%" style="stop-color:#c97b9a" />
                <stop offset="100%" style="stop-color:#e8b4c8" />
              </linearGradient>
            </defs>
            <path id="flask-body" d="M 70 15 L 105 160 Q 110 175 70 175 Q 30 175 35 160 Z" fill="url(#flaskGlass)" stroke="#5a8aa0" stroke-width="2" />
            <path id="flask-liquid" d="M 68 45 L 98 160 Q 102 172 70 172 Q 38 172 42 160 Z" fill="url(#flaskAcid)" class="flask-liquid" />
          </svg>
          <span class="apparatus-label">Conical Flask</span>
        </div>

        <!-- NaOH beaker - fill burette -->
        <div class="apparatus beaker beaker-naoh" id="beaker-naoh" title="Click to fill burette with NaOH">
          <svg viewBox="0 0 100 120" class="beaker-svg">
            <defs>
              <linearGradient id="beakerGlass" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#b8d4e8;stop-opacity:0.5" />
                <stop offset="50%" style="stop-color:#e8f4fc;stop-opacity:0.85" />
                <stop offset="100%" style="stop-color:#b8d4e8;stop-opacity:0.5" />
              </linearGradient>
            </defs>
            <path d="M 25 15 L 75 15 L 85 105 L 15 105 Z" fill="url(#beakerGlass)" stroke="#5a8aa0" stroke-width="2" />
            <rect x="20" y="30" width="65" height="70" fill="#7eb8d4" opacity="0.7" rx="2" />
          </svg>
          <span class="apparatus-label">NaOH (aq)</span>
        </div>

        <!-- Pipette - add HCl to flask -->
        <div class="apparatus pipette" id="pipette" title="Click to add HCl to flask">
          <svg viewBox="0 0 50 180" class="pipette-svg">
            <defs>
              <linearGradient id="pipetteGlass" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#b8d4e8;stop-opacity:0.6" />
                <stop offset="50%" style="stop-color:#e8f4fc;stop-opacity:0.9" />
                <stop offset="100%" style="stop-color:#b8d4e8;stop-opacity:0.6" />
              </linearGradient>
            </defs>
            <path d="M 15 0 L 35 0 L 35 140 L 25 160 L 15 140 Z" fill="url(#pipetteGlass)" stroke="#5a8aa0" stroke-width="2" />
            <rect x="18" y="50" width="14" height="85" fill="#e8e0d0" opacity="0.9" rx="1" />
          </svg>
          <span class="apparatus-label">Pipette (HCl)</span>
        </div>

        <!-- Dropper - add indicator -->
        <div class="apparatus dropper" id="dropper" title="Click to add phenolphthalein">
          <svg viewBox="0 0 60 100" class="dropper-svg">
            <defs>
              <linearGradient id="dropperGlass" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#b8d4e8;stop-opacity:0.6" />
                <stop offset="50%" style="stop-color:#e8f4fc;stop-opacity:0.9" />
                <stop offset="100%" style="stop-color:#b8d4e8;stop-opacity:0.6" />
              </linearGradient>
            </defs>
            <path d="M 25 0 L 35 0 L 35 55 Q 35 75 30 85 L 30 95 L 30 100 L 30 95 L 30 85 Q 25 75 25 55 Z" fill="url(#dropperGlass)" stroke="#5a8aa0" stroke-width="2" />
            <circle cx="30" cy="92" r="5" fill="#c97b9a" opacity="0.9" />
          </svg>
          <span class="apparatus-label">Phenolphthalein</span>
        </div>

        <div id="drop-container" class="drop-container" aria-hidden="true"></div>
      </div>

      <aside class="controls-panel">
        <div class="procedure-panel">
          <h3>Procedure</h3>
          <ol class="steps" id="procedure-steps">
            <li data-step="1"><span class="step-num">1</span> Fill burette with NaOH (click NaOH beaker)</li>
            <li data-step="2"><span class="step-num">2</span> Add HCl to flask (click pipette)</li>
            <li data-step="3"><span class="step-num">3</span> Add 2–3 drops indicator (click dropper)</li>
            <li data-step="4"><span class="step-num">4</span> Open tap, add NaOH; swirl flask. Stop at first permanent pink.</li>
            <li data-step="5"><span class="step-num">5</span> Record final burette reading</li>
          </ol>
        </div>
        <div class="status-box">
          <p id="status-text">Start: Click the NaOH beaker to fill the burette.</p>
          <p id="volume-display">Burette: — mL</p>
          <p id="result-display" class="result-display"></p>
        </div>
        <button type="button" class="btn btn-secondary" id="btn-record-reading">Record final reading</button>
        <button type="button" class="btn btn-secondary" id="btn-reset">Start over</button>
      </aside>
    </main>

    <footer class="lab-footer">
      <span>Virtual Chemistry Lab</span> • NaOH (aq) + HCl (aq) → NaCl (aq) + H₂O (l)
    </footer>
  </div>
  <script src="gaze.js"></script>
  <script src="script.js"></script>
</body>
</html>
